---
import SectionContainer from "./sectionContainer.astro";
import ShareIcon from "./icons/shareIcon.astro";
import GitHubIcon from "./icons/brands/githubIcon.astro";
import Share2Icon from "./icons/share2Icon.astro";
import XLetterIcon from "./icons/xLetterIcon.astro";

interface Props {
    name: string;
    username: string;
    img: string;
    link: string;
    certificates?: {
        title: string;
        description: string;
        img: {
            src: string;
            alt: string;
        }
    }[];
}
const { name, username, img, link, certificates } = Astro.props;
---
<SectionContainer>
    <div class="flex justify-around items-end">
        <div
        style={{ backgroundImage: `url(${img})` }}
        class="aspect-square w-44 bg-center bg-cover bg-no-repeat rounded-lg bg-white"
        />
        <button class="py-2 px-3 bg-[#1E1E1E] font-bold rounded-lg" id="github-signout">
            Cerrar sesion
        </button>
    </div>
    <div class="flex items-center gap-x-3 pt-4">
        <h1 class="font-bold text-3xl">
            {name}
        </h1>
        <button>
            <ShareIcon />
        </button>
    </div>
    <a href={link ?? ""} target="_blank" class="flex w-fit gap-x-3 pr-2 opacity-65 items-center font-medium pt-2">
        <GitHubIcon />
        <p class="text-xl">
            {username}
        </p>
    </a>
</SectionContainer>
<SectionContainer class="!px-0 mx-5 border-opacity-50 border-t-[1px] border-t-yellow-300 mt-5 pt-2">
    <h2 class="text-2xl text-yellow-200 font-bold text-center pb-2">
        Certificados
    </h2>
    <ul class="flex flex-col gap-y-2 min-h-[calc(80vh-300px)]">
        {
            certificates && certificates?.length > 0 ? certificates.map(certificate => (
                <li>
                    <div
                    class="flex justify-end items-end p-3 aspect-video w-full rounded-xl bg-[#1E1E1E]"
                    >
                        <Share2Icon />
                    </div>
                </li>
            ))
            :
            <li>
                <div
                class="flex justify-center items-center text-red-300 p-3 aspect-video w-full rounded-xl bg-[#1E1E1E]"
                >
                    <p class="pr-5 font-medium text-xl">No tienes certificados</p>
                    <XLetterIcon />
                </div>
            </li>
        }
    </ul>
</SectionContainer>

<script>
    const { signOut } = await import("auth-astro/client");
    const signoutButton = document.querySelector("#github-signout");

    signoutButton?.addEventListener("click", async () => {
        await signOut();
    });
</script>