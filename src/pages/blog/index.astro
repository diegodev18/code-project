---
import SectionContainer from "@/components/sectionContainer.astro";
import Layout from "@/layouts/Layout.astro";
import { getCollection, render } from "astro:content";

const posts = await getCollection("blog");
---

<Layout
  title="Blog de Code Project"
  description="Ve los últimos artículos de Code Project"
>
  <SectionContainer>
    <h1 class="text-center pt-10 pb-12">
      <span class="text-xl font-semibold text-yellow-300">Bienvenido al</span>
      <span class="text-4xl font-bold text-light-primary">
        Blog de Code Project!
      </span>
    </h1>
  </SectionContainer>
  <div>
    {
      posts.map(({ slug, data }) => {
        const { title, description, date, author, tags } = data;
        const newDate = date.toLocaleDateString("es-ES", {
          year: "numeric",
          month: "long",
          day: "numeric",
        });
        return (
          <SectionContainer>
            <div class="max-w-[650px] mx-auto">
              <p class="flex gap-x-2 text-sm opacity-50 pb-1">
                Tags de '{slug}':{" "}
                <span
                  class="flex items-end gap-x-2 overflow-x-scroll"
                  id="tags-gallery"
                >
                  {tags.map((tag) => (
                    <a
                      class="text-nowrap h-fit font-medium underline bg-nav hover:bg-black transition px-1 rounded-md"
                      href={`/blog?tag=${tag}`}
                    >
                      {tag}
                    </a>
                  ))}
                </span>
              </p>
              <a class="relative group" href={`/blog/${slug}`}>
                <article class="bg-dark-secondary hover:bg-zinc-900 rounded-md px-2 pt-1 pb-2 transition">
                  <h2 class="text-3xl font-semibold text-light-primary pb-1">
                    {title}
                  </h2>
                  <p class="flex flex-wrap justify-between text-sm opacity-50">
                    <span>Autor: {author}</span>
                    <span>Fecha: {newDate}</span>
                  </p>
                  <p class="pt-2">{description}</p>
                </article>
              </a>
            </div>
          </SectionContainer>
        );
      })
    }
  </div>
</Layout>

<style>
  #tags-gallery {
    scrollbar-width: none;
  }
</style>
